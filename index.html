<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
    <title>IITM net access</title>
</head>
<body>
    <!-- roll no and password and submit -->
    <div class="m-3 card">
        <div class="m-2">
            <h1 class="text-center">IITM net access</h1>
        </div>
        <hr>
        <div class="row m-3">
            <div class="col-md-4 mx-auto">
                <div class="mb-3">
                    <label for="rollno" class="form-label">Roll No</label>
                    <input type="text" class="form-control" id="rollno" name="rollno" aria-describedby="rollno">
                </div>
                <div class="mb-3">
                    <label for="password" class="form-label">Password</label>
                    <input type="text" class="form-control" id="password" name="password">
                </div>
                <button type="submit" class="btn btn-primary" id="submit">Submit</button>
            </div>
        </div>
        <hr>
        <div id="result" class="mx-auto" style="display: none; text-align: center;">
        </div>
        <hr>
        <p class="m-2"><b>Note:</b> You need to enter your credentials correctly only once; after that, they will be saved in the browser. If you visit the website again, it will automatically retrieve your saved credentials.</p>
    </div>
</body>
</html>

<script>
    const submit = document.getElementById('submit');
    const result = document.getElementById('result');

    if (localStorage.getItem('rollno') && localStorage.getItem('password')) {
        const rollno = localStorage.getItem('rollno');
        const password = localStorage.getItem('password');
        fetch('https://net-access.onrender.com/access', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                rollno: rollno,
                password: password
        })
        })
        .then((response)=> {
            return response.json();
        })
        .then((data) => {
            console.log(data);
            if (data.success === true) {
                result.innerHTML = `<h2>${data.message}</h1>`;
                result.style.display = 'block';
                result.style.color = 'green';
            } else {
                result.innerHTML = `<h2>${data.message}</h1>`;
                result.style.display = 'block';
                result.style.color = 'red';
            }
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    }

    submit.addEventListener('click', () => {
        const rollno = document.getElementById('rollno').value;
        const password = document.getElementById('password').value;
        
        fetch('https://net-access.onrender.com/access', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                rollno: rollno,
                password: password
        })
        })
        .then((response)=> {
            return response.json();
        })
        .then((data) => {
            console.log(data);
            if (data.success === true) {
                localStorage.setItem('rollno', rollno);
                localStorage.setItem('password', password);
                result.innerHTML = `<h2>${data.message}</h1>`;
                result.style.display = 'block';
                result.style.color = 'green';
            } else {
                result.innerHTML = `<h2>${data.message}</h1>`;
                result.style.display = 'block';
                result.style.color = 'red';
            }
        })
        .catch((error) => {
            console.error('Error:', error);
        });
    })

</script>